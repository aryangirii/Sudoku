<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Play Sudoku</title>
  <link rel="stylesheet" href="/static/style.css">
</head>
<body class="game-screen">
  <div class="container">
    <div class="header">
      <h1>Sudoku - {{ level.capitalize() }}</h1>
      <div class="game-info">
        <span id="timer">Time: 00:00</span>
        <span id="mistakes">Mistakes: 0</span>
      </div>
      <button onclick="toggleTheme()" class="theme-toggle">Toggle Dark Mode</button>
    </div>

    <div class="sudoku-grid">
      {% for row in puzzle %}
        <div class="sudoku-row">
          {% for cell in row %}
            <input maxlength="1" class="sudoku-cell" value="{{ cell if cell != 0 else '' }}" {{ 'readonly' if cell != 0 else '' }}>
          {% endfor %}
        </div>
      {% endfor %}
    </div>
  </div>

  <script>
    let startTime = Date.now();
    let timer = document.getElementById('timer');
    let mistakes = 0;

    setInterval(() => {
      let elapsed = Math.floor((Date.now() - startTime) / 1000);
      let minutes = String(Math.floor(elapsed / 60)).padStart(2, '0');
      let seconds = String(elapsed % 60).padStart(2, '0');
      timer.textContent = `Time: ${minutes}:${seconds}`;
    }, 1000);

    function toggleTheme() {
      document.body.classList.toggle('dark-mode');
    }

    document.querySelectorAll('.sudoku-cell').forEach(cell => {
      const originalValue = cell.value;
      cell.addEventListener('input', () => {
        const val = cell.value;
        if (val && (isNaN(parseInt(val)) || parseInt(val) < 1 || parseInt(val) > 9)) {
          cell.value = '';
        }

        if (originalValue === '') {
          const correct = checkCorrect(cell, val);
          if (!correct) {
            cell.classList.add('wrong');
            mistakes++;
            document.getElementById('mistakes').textContent = `Mistakes: ${mistakes}`;
          } else {
            cell.classList.remove('wrong');
            cell.classList.add('correct');
          }
        }
      });
    });

    function checkCorrect(cell, val) {
      // Placeholder - implement backend validation if needed
      return true; // Always assume correct for demo purposes
    }
  </script>
</body>
</html>
